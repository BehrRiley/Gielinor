# ████████████████████████████████████████████████████
# ██   Passive Skill | Roll
# ██   
# ██   Rolling is a passive skill which allows the player to reduce fall damage.
# ██   Every level, the chance for a successful roll increases by 0.5%,
# ██   with a maximum chance of 50% at level 99. As rolling is a passive skill, 
# ██   it will be activated simply by taking fall damage. When activated,
# ██   it can negate up to 7 hitpoints, or 3.5 hearts.
# ██   
# ██ [ World Script ] ██
Agility_Passive_Roll:
  type: world
  debug: true
  events:
    on entity damaged by Fall:
      - define Fall <proc[Falldmg].context[<context.entity>]>
      - if <def[Fall]> == Rolled:
        - determine cancelled
      - queue clear


Falldmg:
  type: procedure
  debug: true
  definitions: EntityA
  script:
    #██ Entity [A] Agility Level
    - define Agility <def[EntityA].flag[AgilityLevel]||1>
    - define Fall <def[Agility].mul[.005].add[.005]>
    - if <util.random.decimal> < <def[Fall]>:
      - determine "ROLLED"
    - determine "HIT"
    
# Finished Script
# ~Inde/Behr
